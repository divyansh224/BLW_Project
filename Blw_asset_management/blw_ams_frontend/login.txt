<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>BLW AMS Login</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" />
  <script src="https://cdn.tailwindcss.com"></script>
</head>
<body
  class="bg-cover bg-center h-screen flex items-center justify-center"
style="background: url('assets/profile.jpg') no-repeat center center fixed; background-size: cover;">
  <div class="bg-white p-6 rounded shadow-md w-full max-w-md">
    <h2 class="text-2xl font-bold mb-4 text-center">Login to BLW AMS</h2>
   <form id="loginForm">
  <div class="input-group mb-2">
    <input class="form-control" type="password" placeholder="Password" id="password" required />
    <button class="btn btn-outline-secondary" type="button" onclick="togglePassword()">üëÅÔ∏è</button>
  </div>
  <button class="btn btn-primary w-100 mb-2" type="submit">Log in</button>
</form>
<div id="status" class="mt-2 text-info"></div>
<p id="loginStatus"></p>
<script>
    function togglePassword() {
  const pwd = document.getElementById('password');
  pwd.type = pwd.type === 'password' ? 'text' : 'password';
}
</script>
<script>
  document.getElementById('loginForm').onsubmit = async (e) => {
  e.preventDefault();
  const user_id = document.getElementById('user_id').value;
  const password = document.getElementById('password').value;

  document.getElementById('status').innerHTML = `
    <div class="d-flex align-items-center gap-2">
      <div class="spinner-border text-info"></div>
      <span class="text-info">Logging in...</span>
    </div>
  `;

  const res = await fetch('/api/login', {
    method: 'POST',
    headers: { 'Content-Type': 'application/json' },
    body: JSON.stringify({ user_id, password })
  });

  const result = await res.json();
  if (res.ok) {
    localStorage.setItem('user_id', user_id);
    window.location.href = 'dashboard.html';
  } else {
    document.getElementById('status').innerHTML = '<span class="text-danger">' + result.error + '</span>';
  }
};
</script>
</body>
</html>